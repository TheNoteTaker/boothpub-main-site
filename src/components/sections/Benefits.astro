---
import { Icon } from '@/components/ui/Icon';
import { createResponsiveImage, type ResponsiveImageOptions } from '@/utils/images';
import { ScrollSection } from '@/components/animations/ScrollSection';
import { BenefitContent } from '@/components/animations/BenefitContent';
import { ScrollProgress } from '@/components/animations/ScrollProgress';
import BenefitImageWrapper from '@/components/animations/BenefitImageWrapper.astro';
import { motion } from 'framer-motion';

const benefits = [
  {
    name: 'Professional Equipment',
    description: 'Studio-quality DSLR cameras with professional lighting for perfect shots every time.',
    icon: 'Camera',
    image: {
      src: "https://images.unsplash.com/photo-1542038784456-1ea8e935640e",
      alt: "Professional photo booth equipment setup",
    }
  },
  {
    name: 'Expert Service',
    description: 'Our trained staff provides exceptional service, making every event memorable.',
    icon: 'Award',
    image: {
      src: "https://images.unsplash.com/photo-1519671482749-fd09be7ccebf",
      alt: "Professional photo booth attendant helping guests",
    }
  },
  {
    name: 'Premium Experience',
    description: 'Combining photography and bartending for a unique entertainment experience.',
    icon: 'Star',
    image: {
      src: "https://images.unsplash.com/photo-1516450360452-9312f5e86fc7",
      alt: "Guests enjoying premium photo booth experience",
    }
  },
  {
    name: 'Instant Memories',
    description: 'Take home high-quality prints instantly and access digital copies within 24 hours.',
    icon: 'Image',
    image: {
      src: "https://images.unsplash.com/photo-1533174072545-7a4b6ad7a6c3",
      alt: "Instant photo prints from our booth",
    }
  }
];

const imageOptions: ResponsiveImageOptions = {
  width: 800,
  height: 1067,
  format: 'webp',
  quality: 85,
  sizes: "(min-width: 1024px) 800px, (min-width: 640px) 600px, 100vw",
  breakpoints: [400, 600, 800]
};

const benefitImages = await Promise.all(
  benefits.map(benefit => createResponsiveImage({
    ...imageOptions,
    src: benefit.image.src,
    alt: benefit.image.alt
  }))
);
---

<section id="benefits" class="relative bg-white">
  <ScrollProgress client:load />
  <div class="relative">
    <ScrollSection client:load index={0}>
      <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 text-center">
        <div class="inline-flex mb-4 items-center rounded-full bg-[#F9CC9A]/10 px-4 py-1">
          <Icon name="Sparkles" className="mr-2 h-4 w-4 text-[#D75E1F]" client:load />
          <span class="text-sm font-medium text-[#D75E1F]">Why Choose Us</span>
        </div>
        <h2 class="text-3xl sm:text-4xl font-bold tracking-tight text-[#2F505F] sm:text-5xl">
          Elevate Your Events with Premium Photo Experiences
        </h2>
        <p class="mt-4 text-lg text-muted-foreground max-w-2xl mx-auto">
          We combine professional photography with exceptional service to create unforgettable moments at your events.
        </p>
      </div>
    </ScrollSection>

    {benefits.map((benefit, index) => (
      <ScrollSection client:load index={index + 1}>
        <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-x-24 gap-y-12 items-center">
            <BenefitContent
              client:load
              name={benefit.name}
              description={benefit.description}
              icon={benefit.icon}
            />
            <BenefitImageWrapper
              src={benefitImages[index].images[benefitImages[index].images.length - 1].src}
              alt={benefit.image.alt}
              width={800}
              height={1067}
              loading={index === 0 ? "eager" : "lazy"}
              srcset={benefitImages[index].images.map(img => `${img.src} ${img.attributes.width}w`).join(', ')}
              sizes={benefitImages[index].sizes}
            />
          </div>
        </div>
      </ScrollSection>
    ))}
  </div>
</section>

<style>
  #benefits {
    contain: layout paint;
    isolation: isolate;
  }
</style>